<?xml version='1.0' encoding='UTF-8'?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:aop="http://www.springframework.org/schema/aop"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:util="http://www.springframework.org/schema/util"
   xsi:schemaLocation="
      http://www.springframework.org/schema/context
      http://www.springframework.org/schema/context/spring-context-3.0.xsd
      http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
      http://www.springframework.org/schema/aop
      http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
      http://www.springframework.org/schema/util
      http://www.springframework.org/schema/util/spring-util-3.0.xsd">

   <!--  Helper beans -->

   <bean id="baseTransaction" abstract="true" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="baseSecurity" abstract="true" class="org.alfresco.module.org_alfresco_module_rm.security.RMMethodSecurityInterceptor">
        <property name="authenticationManager">
            <ref bean="authenticationManager"/>
        </property>
        <property name="accessDecisionManager">
            <ref bean="accessDecisionManager"/>
        </property>
        <property name="afterInvocationManager">
            <ref bean="afterInvocationManager"/>
        </property>
     </bean>

     <bean id="baseService" abstract="true">
        <property name="nodeService" ref="NodeService"/>
        <property name="dictionaryService" ref="DictionaryService"/>
        <property name="authenticationUtil" ref="rm.authenticationUtil"/>
        <property name='transactionalResourceHelper' ref="rm.transactionalResourceHelper" />
     </bean>

    <!-- Records Management Service Registry -->

    <bean id="RecordsManagementServiceRegistry" class="org.alfresco.module.org_alfresco_module_rm.RecordsManagementServiceRegistryImpl" />

    <!--  Vital Record Service -->

    <bean id="vitalRecordService" parent="baseService" class="org.alfresco.module.org_alfresco_module_rm.vital.VitalRecordServiceImpl">
        <property name="filePlanService" ref="FilePlanService" />
    </bean>

    <bean id="VitalRecordService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.vital.VitalRecordService</value>
        </property>
        <property name="target">
            <ref bean="vitalRecordService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="VitalRecordService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="VitalRecordService_security"/>
            </list>
        </property>
    </bean>

    <bean id="VitalRecordService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="VitalRecordService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.vital.VitalRecordService.*=RM_ALLOW
                ]]>
            </value>
        </property>
    </bean>

    <!--  Disposition Service -->
    <bean id="dispositionService" parent="baseService" class="org.alfresco.module.org_alfresco_module_rm.disposition.DispositionServiceImpl">
        <property name="recordsManagementServiceRegistry" ref="RecordsManagementServiceRegistry"/>
        <property name="behaviourFilter" ref="policyBehaviourFilter" />
        <property name="filePlanService" ref="FilePlanService" />
        <property name="recordFolderService" ref="RecordFolderService"/>
        <property name="recordService" ref="RecordService"/>
        <property name="freezeService" ref="FreezeService"/>
    </bean>

    <bean id="DispositionService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService</value>
        </property>
        <property name="targetSource">
            <bean class="org.alfresco.config.NonBlockingLazyInitTargetSource">
                <property name="targetBeanName">
                   <idref bean="dispositionService"/>
                </property>
            </bean>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="DispositionService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="DispositionService_security"/>
            </list>
        </property>
    </bean>

    <bean id="DispositionService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="DispositionService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.registerDispositionProperty=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getDispositionProperties=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getDispositionSchedule=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getOriginDispositionSchedule=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getAssociatedDispositionSchedule=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getAssociatedRecordsManagementContainer=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.hasDisposableItems=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.isDisposableItem=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getDisposableItems=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.createDispositionSchedule=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.addDispositionActionDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.removeDispositionActionDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.updateDispositionActionDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.isNextDispositionActionEligible=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getNextDispositionAction=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.recalculateNextDispositionStep=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getCompletedDispositionActions=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.getLastCompletedDispostionAction=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.isDisposableItemCutoff=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.cutoffDisposableItem=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.calculateAsOfDate=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.disposition.DispositionService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!--  Transfer Service -->
    <bean id="rmTransferService" class="org.alfresco.module.org_alfresco_module_rm.transfer.TransferServiceImpl" parent="baseService">
        <property name="filePlanService" ref="FilePlanService" />
        <property name="dispositionService" ref="dispositionService" />
        <property name="recordService" ref="RecordService" />
        <property name="recordFolderService" ref="RecordFolderService" />
        <property name="nodeService" ref="nodeService"/>
        <property name="freezeService" ref="FreezeService"/>
        <property name="transferContainerType" ref="rma.transferContainer"/>
        <property name="transferType" ref="rma.transfer"/>
    </bean>

    <bean id="RmTransferService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.transfer.TransferService</value>
        </property>
        <property name="target">
            <ref bean="rmTransferService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="rmTransferService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="rmTransferService_security"/>
            </list>
        </property>
    </bean>

    <bean id="rmTransferService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="rmTransferService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.transfer.TransferService.isTransfer=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.transfer.TransferService.transfer=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.transfer.TransferService.completeTransfer=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.transfer.TransferService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!--  Capability Service -->

    <bean id="capabilityService" class="org.alfresco.module.org_alfresco_module_rm.capability.CapabilityServiceImpl">
    </bean>

    <bean id="CapabilityService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.capability.CapabilityService</value>
        </property>
        <property name="target">
            <ref bean="capabilityService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="CapabilityService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <!-- <idref local="CapabilityService_security"/>  -->
            </list>
        </property>
    </bean>

    <bean id="CapabilityService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="CapabilityService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.capability.CapabilityService.*=RM_ALLOW
                ]]>
            </value>
        </property>
    </bean>

    <!--  Records Management Search Service -->

    <bean id="recordsManagementSearchService" class="org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchServiceImpl">
        <property name="fileFolderService" ref="FileFolderService"/>
        <property name="siteService" ref="SiteService"/>
        <property name="namespaceService" ref="NamespaceService" />
        <property name="searchService" ref="SearchService" />
        <property name="reportsJSON">
           <value>
                <![CDATA[
                [
                   {
                      "name" : "rm.savedsearch.vitalRecordsName",
                      "description" : "rm.savedsearch.vitalRecordsDesc",
                      "search" : "rma:reviewAsOf:[MIN TO TODAY]",
                      "searchparams" :
                      {
                         "records" : true,
                         "recordfolders" : false,
                         "vitalrecords" : true
                      }
                   },
                   {
                      "name" : "rm.savedsearch.incompleteRecordsName",
                      "description" : "rm.savedsearch.incompleteRecordsDesc",
                      "search" : "ISNODE:T AND NOT ASPECT:\"rma:declaredRecord\"",
                      "searchparams" :
                      {
                         "records" : true,
                         "recordfolders" : false,
                         "undeclaredrecords" : true
                      }
                   },
                   {
                      "name" : "rm.savedsearch.cutoffRecordsName",
                      "description" : "rm.savedsearch.cutoffRecordsDesc",
                      "search" : "dispositionActionName:\"cutoff\" AND (dispositionEventsEligible:true OR dispositionActionAsOf:[MIN TO TODAY]) AND NOT ASPECT:\"rma:cutoff\"",
                      "searchparams" :
                      {
                         "records" : true,
                         "recordfolders" : true
                      }
                   },
                   {
                      "name" : "rm.savedsearch.transferRecordsName",
                      "description" : "rm.savedsearch.transferRecordsDesc",
                      "search" : "dispositionActionName:\"transfer\" AND (dispositionEventsEligible:true OR dispositionActionAsOf:[MIN TO TODAY]) AND NOT ASPECT:\"rma:transferred\" AND NOT ASPECT:\"rma:transferring\"",
                      "searchparams" :
                      {
                         "records" : true,
                         "recordfolders" : true,
                         "cutoff" : true
                      }
                   },
                   {
                      "name" : "rm.savedsearch.destructionRecordsName",
                      "description" : "rm.savedsearch.destructionRecordsDesc",
                      "search" : "dispositionActionName:\"destroy\" AND (dispositionEventsEligible:true OR dispositionActionAsOf:[MIN TO TODAY]) AND NOT ASPECT:\"rma:ghosted\"",
                      "searchparams" :
                      {
                         "records" : true,
                         "recordfolders" : true,
                         "cutoff" : true
                      }
                   },
                   {
                      "name" : "rm.savedsearch.frozenRecordsName",
                      "description" : "rm.savedsearch.frozenRecordsDesc",
                      "search" : "ISNODE:T",
                      "searchparams" :
                      {
                         "records" : true,
                         "recordfolders" : true,
                         "frozen" : true,
                         "undeclaredrecords" : true
                      }
                   }
                ]
                ]]>
            </value>
        </property>
    </bean>

    <bean id="RecordsManagementSearchService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService</value>
        </property>
        <property name="target">
            <ref bean="recordsManagementSearchService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordsManagementSearchService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordsManagementSearchService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordsManagementSearchService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="RecordsManagementSearchService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.search=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.getSavedSearches=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.getSavedSearch=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.saveSearch=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.deleteSavedSearch=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.addReports=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.search.RecordsManagementSearchService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!--  File Plan Service -->

	<bean id="rootContainerCache" class="org.alfresco.repo.cache.DefaultSimpleCache" />

	<bean id="filePlanService"
	      parent="baseService"
          class="org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanServiceImpl">
        <property name="rootContainerCache" ref="rootContainerCache" />
    </bean>

    <bean id="FilePlanService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService</value>
        </property>
        <property name="targetSource">
            <bean class="org.alfresco.config.NonBlockingLazyInitTargetSource">
                <property name="targetBeanName">
                   <idref bean="filePlanService"/>
                </property>
            </bean>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="FilePlanService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="FilePlanService_security"/>
            </list>
        </property>
    </bean>

    <bean id="FilePlanService_transaction" parent="baseTransaction" />

    <bean id="FilePlanService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.isFilePlanComponent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getFilePlanComponentKind=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getFilePlanComponentKindFromType=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.isFilePlan=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getFilePlans=RM_ALLOW,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getFilePlan=RM_ALLOW,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getFilePlanBySiteId=RM_ALLOW,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.existsUnfiledContainer=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getUnfiledContainer=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.createUnfiledContainer=RM.Create.0
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getHoldContainer=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.createHoldContainer=RM.Create.0
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getTransferContainer=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.createTransferContainer=RM.Create.0
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.createFilePlan=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getNodeRefPath=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.isFilePlanContainer=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.isRecordCategory=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getAllContained=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getContainedRecordCategories=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.getContainedRecordFolders=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.createRecordCategory=RM.Create.0
                org.alfresco.module.org_alfresco_module_rm.fileplan.FilePlanService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

   <!--  File Plan Permission Service -->

   <bean id="filePlanPermissionService"
         parent="baseService"
          class="org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionServiceImpl"
          init-method="init">
        <property name="permissionService" ref="PermissionService"/>
        <property name="policyComponent" ref="policyComponent"/>
        <property name="ownableService" ref="ownableService" />
        <property name="authorityService" ref="AuthorityService" />
        <property name="filePlanRoleService" ref="FilePlanRoleService" />
        <property name="filePlanService" ref="FilePlanService" />
    </bean>

    <bean id="FilePlanPermissionService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionService</value>
        </property>
        <property name="target">
            <ref bean="filePlanPermissionService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="FilePlanPermissionService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="FilePlanPermissionService_security"/>
            </list>
        </property>
    </bean>

    <bean id="FilePlanPermissionService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="FilePlanPermissionService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionService.setupRecordCategoryPermissions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionService.setupPermissions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionService.setPermission=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionService.deletePermission=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.security.FilePlanPermissionService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!-- File Plan Role Service -->

    <bean id="filePlanRoleService"
          class="org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleServiceImpl"
          depends-on="org_alfresco_module_rm_dictionaryBootstrap">
        <property name="capabilityService" ref="CapabilityService"/>
        <property name="authorityService" ref="AuthorityService"/>
        <property name="permissionService" ref="PermissionService"/>
        <property name="nodeService" ref="NodeService"/>
        <property name="filePlanService" ref="FilePlanService" />
        <!-- init repo for when a tenant is created -->
        <property name="bootstrapImporterModuleComponent" ref="org_alfresco_module_rm_bootstrapData"/>

    </bean>

    <bean id="FilePlanRoleService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService</value>
        </property>
        <property name="target">
            <ref bean="filePlanRoleService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="FilePlanRoleService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="FilePlanRoleService_security"/>
            </list>
        </property>
    </bean>

    <bean id="FilePlanRoleService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="FilePlanRoleService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
               <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.setupFilePlanRoles=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.tearDownFilePlanRoles=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getRoles=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getRolesByUser=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getRole=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.existsRole=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.hasRMAdminRole=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.createRole=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.updateRole=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.deleteRole=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getUsersAssignedToRole=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getGroupsAssignedToRole=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getAllAssignedToRole=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.assignRoleToAuthority=RM_CAP.0.rma:filePlanComponent.ManageAccessControls
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.unassignRoleFromAuthority=RM_CAP.0.rma:filePlanComponent.ManageAccessControls
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.getAllRolesContainerGroup=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.role.FilePlanRoleService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>


    <!--  Records Management Extended Security Service -->

    <bean id="extendedSecurityService"
          class="org.alfresco.module.org_alfresco_module_rm.security.ExtendedSecurityServiceImpl"
          parent="baseService">
        <property name="nodeService" ref="nodeService"/>
        <property name="filePlanService" ref="filePlanService" />
        <property name="filePlanRoleService" ref="filePlanRoleService" />
        <property name="authorityService" ref="authorityService"/>
        <property name="permissionService" ref="permissionService"/>
        <property name="transactionService" ref="transactionService"/>
    </bean>

    <bean id="ExtendedSecurityService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.security.ExtendedSecurityService</value>
        </property>
        <property name="target">
            <ref bean="extendedSecurityService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="ExtendedSecurityService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="ExtendedSecurityService_security"/>
            </list>
        </property>
    </bean>

    <bean id="ExtendedSecurityService_transaction" parent="baseTransaction"/>

    <bean id="ExtendedSecurityService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
             org.alfresco.module.org_alfresco_module_rm.security.ExtendedSecurityService.*=RM_ALLOW
                ]]>
            </value>
        </property>
    </bean>

    <!--  Model Security service -->

    <bean id="modelSecurityService"
          class="org.alfresco.module.org_alfresco_module_rm.model.security.ModelSecurityServiceImpl"
          parent = "rm.baseBehaviour">
        <property name="enabled" value="true" />
        <property name="namespaceService" ref="namespaceService" />
        <property name="filePlanService" ref="FilePlanService" />
    </bean>

    <bean id="ModelSecurityService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.model.security.ModelSecurityService</value>
        </property>
        <property name="target">
            <ref bean="modelSecurityService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="ModelSecurityService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="ModelSecurityService_security"/>
            </list>
        </property>
    </bean>

    <bean id="ModelSecurityService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="ModelSecurityService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
             org.alfresco.module.org_alfresco_module_rm.model.security.ModelSecurityService.*=RM_ALLOW
                ]]>
            </value>
        </property>
    </bean>

    <!-- Records Management Action Service -->

    <bean id="recordsManagementActionService" class="org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionServiceImpl" init-method="init">
        <property name="policyComponent" ref="policyComponent"/>
        <property name="nodeService" ref="nodeService"/>
    </bean>

    <bean id="RecordsManagementActionService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService</value>
        </property>
        <property name="target">
            <ref bean="recordsManagementActionService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordsManagementActionService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordsManagementActionService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordsManagementActionService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>


    <bean id="RecordsManagementActionService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.getRecordsManagementActions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.getRecordsManagementActionConditions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.getDispositionActions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.getRecordsManagementAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.getDispositionAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.executeRecordsManagementAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.executeRecordsManagementAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.executeRecordsManagementAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.executeRecordsManagementAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.executeRecordsManagementAction=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.register=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.register=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.action.RecordsManagementActionService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!-- Records Management Event Service -->

    <bean id="recordsManagementEventService" class="org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventServiceImpl">
      <property name="nodeService" ref="NodeService"/>
      <property name="contentService" ref="ContentService"/>
    </bean>

    <bean id="RecordsManagementEventService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService</value>
        </property>
        <property name="target">
            <ref bean="recordsManagementEventService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordsManagementEventService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordsManagementEventService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordsManagementEventService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>


    <bean id="RecordsManagementEventService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.registerEventType=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.getEventTypes=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.getEventType=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.getEvents=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.getEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.addEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.removeEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.existsEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.canCreateEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.canEditEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.event.RecordsManagementEventService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

   <bean id="recordsManagementAdminBase" class="org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminBase" abstract="true">
      <property name="dictionaryService" ref="DictionaryService"/>
      <property name="nodeService" ref="NodeService"/>
      <property name="contentService" ref="contentService"/>
      <property name="namespaceService" ref="NamespaceService"/>
      <property name="dictionaryRepositoryBootstrap" ref="dictionaryRepositoryBootstrap"/>
   </bean>

   <!-- Records Management Admin Service -->

   <bean id="recordsManagementAdminService" class="org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminServiceImpl" parent="recordsManagementAdminBase">
      <property name="relationshipService" ref="RelationshipService" />
      <property name="transactionService" ref="transactionService"/>
      <property name="customisableTypes">
         <list>
            <value>rma:recordCategory</value>
            <value>rma:recordFolder</value>
            <value>rma:record</value>
            <value>rma:nonElectronicDocument</value>
         </list>
      </property>
   </bean>

    <bean id="RecordsManagementAdminService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService</value>
        </property>
        <property name="target">
            <ref bean="recordsManagementAdminService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordsManagementAdminService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordsManagementAdminService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordsManagementAdminService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>


    <bean id="RecordsManagementAdminService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomisable=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.isCustomisable=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.makeCustomisable=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.unmakeCustomisable=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.existsCustomProperty=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomPropertyDefinitions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.addCustomPropertyDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.updateCustomPropertyDefinitionName=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.setCustomPropertyDefinitionLabel=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.setCustomPropertyDefinitionConstraint=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.removeCustomPropertyDefinitionConstraints=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.removeCustomPropertyDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.addCustomAssocDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.addCustomChildAssocDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.updateCustomAssocDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.updateCustomChildAssocDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomReferenceDefinitions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomReferencesFrom=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomReferencesTo=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomChildReferences=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomParentReferences=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.addCustomReference=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.removeCustomReference=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCustomConstraintDefinitions=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.addCustomConstraintDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.removeCustomConstraintDefinition=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.changeCustomConstraintValues=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getQNameForClientId=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.splitSourceTargetId=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.getCompoundIdFor=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.admin.RecordsManagementAdminService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!--  Freeze Service  -->

    <bean id="freezeService" class="org.alfresco.module.org_alfresco_module_rm.freeze.FreezeServiceImpl">
        <property name="nodeService" ref="nodeService" />
        <property name="dictionaryService" ref="DictionaryService" />
        <property name="filePlanService" ref="FilePlanService" />
        <property name="holdService" ref="HoldService" />
    </bean>

    <bean id="FreezeService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService</value>
        </property>
        <property name="target">
            <ref bean="freezeService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="FreezeService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="FreezeService_security"/>
            </list>
        </property>
    </bean>

    <bean id="FreezeService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="FreezeService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.isHold=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.isFrozen=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.getFrozen=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.freeze=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.unFreeze=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.relinquish=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.getReason=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.updateReason=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.getHolds=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.hasFrozenChildren=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.getFreezeDate=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.getFreezeInitiator=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.freeze.FreezeService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!-- Records Management Audit Service -->

    <bean id="recordsManagementAuditService" class="org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditServiceImpl" init-method="init">
        <property name="policyComponent" ref="policyComponent" />
        <property name="dictionaryService" ref="dictionaryService" />
        <property name="transactionService" ref="transactionService" />
        <property name="nodeService" ref="nodeService" />
        <property name="auditComponent" ref="auditComponent" />
        <property name="auditService" ref="auditService" />
        <property name="contentService" ref="ContentService" />
        <property name="recordsManagementActionService" ref="RecordsManagementActionService" />
        <property name="filePlanService" ref="FilePlanService" />
        <property name="namespaceService" ref="NamespaceService" />
        <property name="capabilityService" ref="CapabilityService" />
        <property name="ignoredAuditProperties">
            <list>
                <value>cm:lastThumbnailModification</value>
                <value>cm:autoVersion</value>
                <value>cm:autoVersionOnUpdateProps</value>
                <value>cm:initialVersion</value>
            </list>
        </property>
    </bean>

    <bean id="RecordsManagementAuditService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService</value>
        </property>
        <property name="target">
            <ref bean="recordsManagementAuditService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordsManagementAuditService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordsManagementAuditService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordsManagementAuditService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="RecordsManagementAuditService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.registerAuditEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.auditEvent=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.clearAuditLog=RM_CAP.0.rma:filePlanComponent.DeleteAudit
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.getAuditTrail=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.getAuditTrailFile=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.getDateAuditLogLastStarted=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.getDateAuditLogLastStopped=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.isAuditLogEnabled=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.startAuditLog=RM_CAP.0.rma:filePlanComponent.EnableDisableAuditByTypes
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.stopAuditLog=RM_CAP.0.rma:filePlanComponent.EnableDisableAuditByTypes
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.fileAuditTrailAsRecord=RM_CAP.1.rma:filePlanComponent.DeclareAuditAsRecord
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.getAuditEvents=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.audit.RecordsManagementAuditService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!--  Record Folder Service -->

    <bean id="recordFolderService" class="org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderServiceImpl">
        <property name="nodeService" ref="NodeService"/>
        <property name="dispositionService" ref="DispositionService" />
        <property name="dictionaryService" ref="DictionaryService" />
        <property name="filePlanService" ref="FilePlanService" />
        <property name="recordService" ref="RecordService" />
    </bean>

    <bean id="RecordFolderService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService</value>
        </property>
        <property name="target">
            <ref bean="recordFolderService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordFolderService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordFolderService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordFolderService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="RecordFolderService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.isRecordFolder=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.isRecordFolderDeclared=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.isRecordFolderClosed=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.createRecordFolder=RM.Create.0
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.getRecordFolders=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.setupRecordFolder=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.closeRecordFolder=RM_CAP.0.rma:filePlanComponent.CloseFolders
                org.alfresco.module.org_alfresco_module_rm.recordfolder.RecordFolderService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <!--  Record Service -->

    <bean id="recordService" parent="rm.baseBehaviour" class="org.alfresco.module.org_alfresco_module_rm.record.RecordServiceImpl" init-method="init">
        <property name="identifierService" ref="recordsManagementIdentifierService"/>
        <property name="extendedPermissionService" ref="ExtendedPermissionService"/>
        <property name="extendedSecurityService" ref="ExtendedSecurityService" />
        <property name="policyComponent" ref="policyComponent" />
        <property name="filePlanService" ref="FilePlanService" />
        <property name="ownableService" ref="OwnableService" />
        <property name="notificationHelper" ref="recordsManagementNotificationHelper"/>
        <property name="capabilityService" ref="CapabilityService" />
        <property name="ruleService" ref="RuleService" />
        <property name="fileFolderService" ref="FileFolderService" />
        <property name="recordFolderService" ref="RecordFolderService" />
        <property name="filePlanRoleService" ref="FilePlanRoleService" />
        <property name="permissionService" ref="permissionService" />
        <property name="versionService" ref="VersionService" />
        <property name="relationshipService" ref="RelationshipService" />
        <property name="recordsManagementContainerType" ref="rma.recordsManagementContainer"/>
        <property name="renditionService" ref="RenditionService" />
        <property name="dispositionService" ref="DispositionService"/>
        <property name="recordableVersionService" ref="RecordableVersionService"/>
        <property name="alwaysEditURIs" ref="recordService_alwaysEditURIs" />
    </bean>

   <!-- Defines a list of namespace URIs for properties, which should be always editable -->
   <util:list id="recordService_alwaysEditURIs" value-type="java.lang.String">
      <value>http://www.alfresco.org/model/security/1.0</value>
      <value>http://www.alfresco.org/model/system/1.0</value>
      <value>http://www.alfresco.org/model/workflow/1.0</value>
      <value>http://www.alfresco.org/model/application/1.0</value>
      <value>http://www.alfresco.org/model/datalist/1.0</value>
      <value>http://www.alfresco.org/model/dictionary/1.0</value>
      <value>http://www.alfresco.org/model/bpm/1.0</value>
      <value>http://www.alfresco.org/model/rendition/1.0</value>
   </util:list>

    <bean id="recordMetadataAspectBootstrap" class="org.alfresco.module.org_alfresco_module_rm.record.RecordMetadataBootstrap" init-method="init" abstract="true">
    	<property name="recordService" ref="recordService"/>
    	<property name="namespaceService" ref="namespaceService"/>
    </bean>

    <bean id="RecordService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.record.RecordService</value>
        </property>
        <property name="targetSource">
            <bean class="org.alfresco.config.NonBlockingLazyInitTargetSource">
                <property name="targetBeanName">
                   <idref bean="recordService"/>
                </property>
            </bean>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="RecordService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="RecordService_security"/>
            </list>
        </property>
    </bean>

    <bean id="RecordService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="RecordService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.registerRecordMetadataAspect=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.disablePropertyEditableCheck=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.enablePropertyEditableCheck=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.getRecordMetaDataAspects=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isRecordMetadataAspect=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isRecordMetadataProperty=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.getRecordMetadataAspects=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isRecord=ACL_ALLOW,RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isDeclared=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isFiled=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.createRecord=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.createRecordFromContent=RM.Create.0
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.createRecordFromCopy=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.file=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isPropertyEditable=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.isMetadataStub=RM.Read.0
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.rejectRecord=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.getRecords=RM.Read.0,AFTER_RM.FilterNode
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.addRecordType=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.makeRecord=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.link=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.unlink=RM_ALLOW
                org.alfresco.module.org_alfresco_module_rm.record.RecordService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

   <!--  Inplace Record Service -->

   <bean id="inplaceRecordService" parent="baseService" class="org.alfresco.module.org_alfresco_module_rm.record.InplaceRecordServiceImpl">
      <property name="siteService" ref="SiteService" />
      <property name="extendedSecurityService" ref="ExtendedSecurityService" />
      <property name="fileFolderService" ref="FileFolderService" />
    </bean>

   <bean id="InplaceRecordService" class="org.springframework.aop.framework.ProxyFactoryBean">
      <property name="proxyInterfaces">
         <value>org.alfresco.module.org_alfresco_module_rm.record.InplaceRecordService</value>
      </property>
      <property name="targetSource">
         <bean class="org.alfresco.config.NonBlockingLazyInitTargetSource">
            <property name="targetBeanName">
               <idref bean="inplaceRecordService"/>
            </property>
         </bean>
      </property>
      <property name="interceptorNames">
         <list>
            <idref local="InplaceRecordService_transaction"/>
            <idref bean="exceptionTranslator"/>
            <idref local="InplaceRecordService_security"/>
         </list>
      </property>
   </bean>

   <bean id="InplaceRecordService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
      <property name="transactionManager">
         <ref bean="transactionManager"/>
      </property>
      <property name="transactionAttributes">
         <props>
            <prop key="*">${server.transaction.mode.default}</prop>
         </props>
      </property>
   </bean>

   <bean id="InplaceRecordService_security" parent="baseSecurity">
      <property name="objectDefinitionSource">
         <value>
            <![CDATA[
               org.alfresco.module.org_alfresco_module_rm.record.InplaceRecordService.hideRecord=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.record.InplaceRecordService.moveRecord=RM.Create.0
               org.alfresco.module.org_alfresco_module_rm.record.InplaceRecordService.*=RM_DENY
            ]]>
         </value>
      </property>
   </bean>

   <!--  File Plan Authentication Service -->
   <bean id="filePlanAuthenticationService"
      class="org.alfresco.module.org_alfresco_module_rm.security.FilePlanAuthenticationServiceImpl" />

   <bean id="FilePlanAuthenticationService" class="org.springframework.aop.framework.ProxyFactoryBean">
      <property name="proxyInterfaces">
         <value>org.alfresco.module.org_alfresco_module_rm.security.FilePlanAuthenticationService</value>
      </property>
      <property name="target">
         <ref bean="filePlanAuthenticationService"/>
      </property>
      <property name="interceptorNames">
         <list>
            <idref local="FilePlanAuthenticationService_transaction"/>
            <idref bean="exceptionTranslator"/>
            <idref local="FilePlanAuthenticationService_security"/>
         </list>
      </property>
   </bean>

   <bean id="FilePlanAuthenticationService_transaction" parent="baseTransaction"/>

   <bean id="FilePlanAuthenticationService_security" parent="baseSecurity">
      <property name="objectDefinitionSource">
         <value>
            <![CDATA[
            org.alfresco.module.org_alfresco_module_rm.security.FilePlanAuthenticationService.*=RM_ALLOW
            ]]>
         </value>
      </property>
   </bean>

    <!--  Custom EMail Mapping Service -->
    <bean id="customEmailMappingService"
      class="org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingServiceImpl" >
      <property name="extracter" ref="extracter.RFC822" />
      <property name="nodeService" ref="nodeService" />
      <property name="contentService" ref="contentService"/>
      <property name="namespacePrefixResolver">
         <ref bean="namespaceService"></ref>
      </property>
      <property name="transactionService"><ref bean="transactionService" /></property>
      <property name="emailMappingKeys">
         <list>
            <value>Thread-Index</value>
            <value>messageFrom</value>
            <value>messageTo</value>
            <value>messageCc</value>
            <value>messageSubject</value>
            <value>messageSent</value>
         </list>
      </property>
   </bean>

    <bean id="CustomEmailMappingService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

        <bean id="CustomEmailMappingService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                    org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingService.getCustomMappings=RM_ALLOW
                    org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingService.addCustomMapping=RM_ALLOW
                    org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingService.deleteCustomMapping=RM_ALLOW
                    org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingService.getEmailMappingKeys=RM_ALLOW
                    org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>


    <bean id="CustomEmailMappingService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <list>
                <value>org.alfresco.module.org_alfresco_module_rm.email.CustomEmailMappingService</value>
            </list>
        </property>
        <property name="targetName">
            <value>customEmailMappingService</value>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="CustomEmailMappingService_transaction"/>
                <idref local="CustomEmailMappingService_security"/>
                <idref bean="exceptionTranslator"/>
            </list>
        </property>
    </bean>

    <!--  RM Notification Helper -->
    <bean id="recordsManagementNotificationHelper" class="org.alfresco.module.org_alfresco_module_rm.notification.RecordsManagementNotificationHelper" >
        <property name="filePlanRoleService" ref="FilePlanRoleService"/>
       <property name="notificationService" ref="NotificationService"/>
       <property name="filePlanService" ref="FilePlanService"/>
        <property name="nodeService" ref="nodeService"/>
        <property name="tenantAdminService" ref="tenantAdminService"/>
        <property name="namespaceService" ref="namespaceService"/>
        <property name="searchService" ref="searchService"/>
        <property name="siteService" ref="SiteService" />
        <property name="authorityService" ref="authorityService" />
       <property name="notificationRole" value="${rm.notification.role}"/>
    </bean>

    <!-- RM caveats -->

    <bean id="caveatConfigService" class="org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigServiceImpl">
        <property name="caveatConfigComponent" ref="caveatConfigComponent"/>
        <property name="dictionaryService" ref="dictionaryService"/>
        <property name="namespaceService" ref="namespaceService" />
        <property name="recordsManagementAdminService" ref = "recordsManagementAdminService"/>
    </bean>

    <bean id="caveatConfigComponent"
          class="org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigComponentImpl"
          depends-on="org_alfresco_module_rm_dictionaryBootstrap">
        <property name="contentService" ref="contentService"/>
        <property name="dictionaryService" ref="dictionaryService"/>
        <property name="namespaceService" ref="namespaceService"/>
        <property name="authorityService" ref="authorityService"/>
        <property name="personService" ref="personService"/>
        <property name="nodeService" ref="nodeService"/>
        <property name="caveatAspects" ref="caveatAspects"/>
        <property name="caveatModels" ref="caveatModels"/>
        <property name="caveatConfig" ref="caveatConfigCache"/>
    </bean>

     <!-- ===================================== -->
     <!-- Record Management Caveat Config Cache -->
     <!-- ===================================== -->

     <!-- The cross-transaction shared cache for in-memory CaveatConfig -->

     <bean name="caveatConfigSharedCache" class="org.alfresco.repo.cache.DefaultSimpleCache"/>

    <!-- The transactional cache for in-memory CaveatConfig -->

    <bean name="caveatConfigCache" class="org.alfresco.repo.cache.TransactionalCache">
        <property name="sharedCache">
            <ref bean="caveatConfigSharedCache" />
        </property>
        <property name="name">
            <value>org.alfresco.caveatConfigTransactionalCache</value>
        </property>
        <property name="maxCacheSize" value="500" />
        <property name="mutable" value="true" />
        <property name="disableSharedCache" value="${system.cache.disableMutableSharedCaches}" />
    </bean>

    <bean id="caveatAspects" class="java.util.ArrayList" >
      <constructor-arg>
         <list>
            <value>{http://www.alfresco.org/model/recordsmanagement/1.0}recordComponentIdentifier</value>
         </list>
      </constructor-arg>
   </bean>

   <bean id="caveatModels" class="java.util.ArrayList" >
      <constructor-arg>
         <list>
            <value>{http://www.alfresco.org/model/rmcustom/1.0}rmcustom</value>
         </list>
      </constructor-arg>
   </bean>

    <bean id="rmListOfValuesContraintInit" class="org.alfresco.module.org_alfresco_module_rm.caveat.RMListOfValuesConstraint">
        <property name="caveatConfigService" ref="caveatConfigService"/>
    </bean>

    <bean id="CaveatConfigService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.getRMAllowedValues=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.hasAccess=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.getRMConstraint=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.getAllRMConstraints=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.getListDetails=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.updateOrCreateCaveatConfig=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.addRMConstraint=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.updateRMConstraintAllowedValues=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.updateRMConstraintTitle=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.deleteRMConstraint=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.addRMConstraintListValue=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.updateRMConstraintListAuthority=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.removeRMConstraintListAuthority=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.updateRMConstraintListValue=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.removeRMConstraintListValue=RM_ALLOW
                   org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService.*=RM_DENY
                ]]>
            </value>
        </property>
    </bean>

    <bean id="CaveatConfigService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="CaveatConfigService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <list>
                <value>org.alfresco.module.org_alfresco_module_rm.caveat.RMCaveatConfigService</value>
            </list>
        </property>
        <property name="targetName">
            <value>caveatConfigService</value>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="CaveatConfigService_transaction"/>
                <idref local="CaveatConfigService_security"/>
                <idref bean="exceptionTranslator"/>
            </list>
        </property>
    </bean>

    <!--  Site service work around (see https://issues.alfresco.com/jira/browse/RM-387) -->
    <bean name="siteGetChildrenCannedQueryFactory" class="org.alfresco.module.org_alfresco_module_rm.site.GetChildrenCannedQueryFactory">
        <property name="registry" ref="siteCannedQueryRegistry"/>
        <property name="dictionaryService" ref="dictionaryService"/>
        <property name="tenantService" ref="tenantService"/>
        <property name="nodeDAO" ref="nodeDAO"/>
        <property name="nodeService" ref="nodeService"/>
        <property name="qnameDAO" ref="qnameDAO"/>
        <property name="localeDAO" ref="localeDAO"/>
        <property name="contentDataDAO" ref="contentDataDAO"/>
        <property name="cannedQueryDAO" ref="cannedQueryDAO"/>
        <property name="methodSecurity" ref="SiteService_security_listSites"/>
    </bean>

    <!--  Data Set Service -->

    <bean id="dataSetService" class="org.alfresco.module.org_alfresco_module_rm.dataset.DataSetServiceImpl">
        <property name="importerService" ref="ImporterService"/>
        <property name="searchService" ref="SearchService"/>
        <property name="nodeService" ref="NodeService"/>
        <property name="filePlanService" ref="FilePlanService"/>
        <property name="permissionService" ref="PermissionService"/>
        <property name="authorityService" ref="AuthorityService"/>
        <property name="filePlanRoleService" ref="FilePlanRoleService"/>
        <property name="recordsManagementSearchBehaviour" ref="recordsManagementSearchBehaviour"/>
        <property name="dispositionService" ref="DispositionService"/>
        <property name="recordFolderService" ref="RecordFolderService"/>
    </bean>

    <bean id="DataSetService" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="proxyInterfaces">
            <value>org.alfresco.module.org_alfresco_module_rm.dataset.DataSetService</value>
        </property>
        <property name="target">
            <ref bean="dataSetService"/>
        </property>
        <property name="interceptorNames">
            <list>
                <idref local="DataSetService_transaction"/>
                <idref bean="exceptionTranslator"/>
                <idref local="DataSetService_security"/>
            </list>
        </property>
    </bean>

    <bean id="DataSetService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager">
            <ref bean="transactionManager"/>
        </property>
        <property name="transactionAttributes">
            <props>
                <prop key="*">${server.transaction.mode.default}</prop>
            </props>
        </property>
    </bean>

    <bean id="DataSetService_security" parent="baseSecurity">
        <property name="objectDefinitionSource">
            <value>
                <![CDATA[
                org.alfresco.module.org_alfresco_module_rm.dataset.DataSetService.*=RM_ALLOW
                ]]>
            </value>
        </property>
    </bean>

    <!-- Data Set Implementations -->

    <bean id="dataSetBase" abstract="true" init-method="register" class="org.alfresco.module.org_alfresco_module_rm.dataset.DataSetBase">
        <property name="dataSetService" ref="dataSetService"/>
    </bean>

    <bean id="dataSetDOD5015" parent="dataSetBase">
        <property name="id" value="dod5015"/>
        <property name="path" value="alfresco/module/org_alfresco_module_rm/dod5015/DODExampleFilePlan.xml" />
    </bean>

   <!--  Hold Service -->

   <bean id="holdService"
         parent="baseService"
         class="org.alfresco.module.org_alfresco_module_rm.hold.HoldServiceImpl"
         init-method="init">
      <property name="filePlanService" ref="FilePlanService" />
      <property name="recordService" ref="RecordService" />
      <property name="recordFolderService" ref="RecordFolderService" />
      <property name="permissionService" ref="PermissionService"/>
      <property name="recordsManagementAuditService" ref="RecordsManagementAuditService" />
   </bean>

   <bean id="HoldService"
         class="org.springframework.aop.framework.ProxyFactoryBean">
      <property name="proxyInterfaces">
         <value>org.alfresco.module.org_alfresco_module_rm.hold.HoldService</value>
      </property>
      <property name="target">
         <ref bean="holdService"/>
      </property>
      <property name="interceptorNames">
         <list>
            <idref local="HoldService_transaction"/>
            <idref bean="exceptionTranslator"/>
            <idref local="HoldService_security"/>
         </list>
      </property>
   </bean>

   <bean id="HoldService_transaction" parent="baseTransaction" />

   <bean id="HoldService_security" parent="baseSecurity">
      <property name="objectDefinitionSource">
         <value>
            <![CDATA[
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.isHold=RM_ALLOW
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.getHolds=RM.Read.0,AFTER_RM.FilterNode
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.getHold=RM.Read.0,AFTER_RM.FilterNode
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.heldBy=RM.Read.0,AFTER_RM.FilterNode
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.getHeld=RM.Read.0,AFTER_RM.FilterNode
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.createHold=RM_CAP.0.rma:filePlanComponent.CreateHold
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.getHoldReason=RM.Read.0
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.setHoldReason=RM_CAP.0.rma:filePlanComponent.EditHold
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.deleteHold=RM_CAP.0.rma:filePlanComponent.DeleteHold
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.addToHold=RM_CAP.0.rma:filePlanComponent.AddToHold
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.addToHolds=RM_ALLOW
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.removeFromHold=RM_CAP.0.rma:filePlanComponent.RemoveFromHold
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.removeFromHolds=RM_ALLOW
			   org.alfresco.module.org_alfresco_module_rm.hold.HoldService.removeFromAllHolds=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.hold.HoldService.*=RM_DENY
            ]]>
         </value>
      </property>
   </bean>

   <!--  Relationship Service  -->

   <bean id="relationshipService" class="org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipServiceImpl" init-method="init" parent="recordsManagementAdminBase">
      <property name="policyComponent" ref="policyComponent"/>
   </bean>

   <bean id="RelationshipService" class="org.springframework.aop.framework.ProxyFactoryBean">
      <property name="proxyInterfaces">
         <value>org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService</value>
      </property>
      <property name="target">
         <ref bean="relationshipService"/>
      </property>
      <property name="interceptorNames">
         <list>
            <idref local="RelationshipService_transaction"/>
            <idref bean="exceptionTranslator"/>
            <idref local="RelationshipService_security"/>
         </list>
      </property>
   </bean>

   <bean id="RelationshipService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
      <property name="transactionManager">
         <ref bean="transactionManager"/>
      </property>
      <property name="transactionAttributes">
         <props>
            <prop key="*">${server.transaction.mode.default}</prop>
         </props>
      </property>
   </bean>

   <bean id="RelationshipService_security" parent="baseSecurity">
      <property name="objectDefinitionSource">
         <value>
            <![CDATA[
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.getRelationshipDefinitions=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.getRelationshipDefinition=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.createRelationshipDefinition=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.updateRelationshipDefinition=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.removeRelationshipDefinition=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.existsRelationshipDefinition=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.getRelationshipsFrom=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.getRelationshipsTo=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.addRelationship=RM_CAP.1.rma:filePlanComponent.ChangeOrDeleteReferences,RM_CAP.2.rma:filePlanComponent.ChangeOrDeleteReferences
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.removeRelationship=RM_CAP.1.rma:filePlanComponent.ChangeOrDeleteReferences,RM_CAP.2.rma:filePlanComponent.ChangeOrDeleteReferences
               org.alfresco.module.org_alfresco_module_rm.relationship.RelationshipService.*=RM_DENY
            ]]>
         </value>
      </property>
   </bean>

   <!--  Recordable Verison Config Service  -->

   <bean id="recordableVersionConfigService" class="org.alfresco.module.org_alfresco_module_rm.recordableversion.RecordableVersionConfigServiceImpl">
      <property name="nodeService" ref="NodeService"/>
   </bean>

   <bean id="RecordableVersionConfigService" class="org.springframework.aop.framework.ProxyFactoryBean">
      <property name="proxyInterfaces">
         <value>org.alfresco.module.org_alfresco_module_rm.recordableversion.RecordableVersionConfigService</value>
      </property>
      <property name="target">
         <ref bean="recordableVersionConfigService"/>
      </property>
      <property name="interceptorNames">
         <list>
            <idref local="RecordableVersionConfigService_transaction"/>
            <idref bean="exceptionTranslator"/>
            <idref local="RecordableVersionConfigService_security"/>
         </list>
      </property>
   </bean>

   <bean id="RecordableVersionConfigService_transaction" class="org.springframework.transaction.interceptor.TransactionInterceptor">
      <property name="transactionManager">
         <ref bean="transactionManager"/>
      </property>
      <property name="transactionAttributes">
         <props>
            <prop key="*">${server.transaction.mode.default}</prop>
         </props>
      </property>
   </bean>

   <bean id="RecordableVersionConfigService_security" parent="baseSecurity">
      <property name="objectDefinitionSource">
         <value>
            <![CDATA[
               org.alfresco.module.org_alfresco_module_rm.recordableversion.RecordableVersionConfigService.getVersions=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.recordableversion.RecordableVersionConfigService.setVersion=RM_ALLOW
               org.alfresco.module.org_alfresco_module_rm.recordableversion.RecordableVersionConfigService.*=RM_DENY
            ]]>
         </value>
      </property>
   </bean>
</beans>
