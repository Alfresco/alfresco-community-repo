<?xml version="1.0" encoding="UTF-8"?>

<!-- Definition of Classified Content Model -->

<model name="clf:classifiedcontent" xmlns="http://www.alfresco.org/model/dictionary/1.0">

   <!-- Meta-data about the model -->
   <description>Classified Content Model</description>
   <author>Roy Wetherall</author>
   <version>1.0</version>

   <!-- Imports are required to allow references to definitions in other models -->
   <imports>
      <!-- Import Alfresco Dictionary Definitions -->
      <import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d"/>
      <!-- Import Alfresco Content Domain Model Definitions -->
      <import uri="http://www.alfresco.org/model/content/1.0" prefix="cm"/>
      <!-- Import Alfresco Content Domain Model Definitions -->
      <import uri="http://www.alfresco.org/model/system/1.0" prefix="sys" />
   </imports>

   <!-- Classified Content Namespace -->
   <namespaces>
      <namespace uri="http://www.alfresco.org/model/classifiedcontent/1.0" prefix="clf"/>
   </namespaces>

   <!-- Model Constraints -->
   <constraints>
      <constraint name="clf:classificationLevelRestriction"
                  type="org.alfresco.module.org_alfresco_module_rm.classification.ClassificationLevelConstraint" />
   </constraints>

   <!-- Types -->
   <types>

   </types>

   <!-- Aspects -->
   <aspects>
      <!--  Classified aspect -->
      <aspect name="clf:classified">
         <properties>
            <property name="clf:initialClassification">
               <title>Initial Classification</title>
               <description>The initial classification</description>
               <type>d:text</type>
               <protected>true</protected>
               <mandatory>true</mandatory>
               <constraints>
                  <constraint ref="clf:classificationLevelRestriction" />
               </constraints>
            </property>
            <property name="clf:currentClassification">
               <title>Current Classification</title>
               <description>The current classification. Set to the same as initial classification</description>
               <type>d:text</type>
               <protected>true</protected>
               <mandatory>true</mandatory>
               <constraints>
                  <constraint ref="clf:classificationLevelRestriction" />
               </constraints>
            </property>
            <property name="clf:classificationAuthority">
               <title>Classification Authority</title>
               <description>The classification authority</description>
               <type>d:text</type>
            </property>
            <property name="clf:classificationReasons">
               <title>Classification Reasons</title>
               <description>Holds the ids of classification reasons</description>
               <type>d:text</type>
               <multiple>true</multiple>
            </property>
         </properties>
      </aspect>

      <!-- Security clearance for a user -->
      <aspect name="clf:securityClearance">
         <properties>
            <property name="clf:clearanceLevel">
               <title>Security Clearance</title>
               <description>The security clearance for this user</description>
               <type>d:text</type>
               <protected>true</protected>
               <mandatory>true</mandatory>
               <multiple>false</multiple>
               <default>NoClearance</default> <!-- TODO Is this value validated against the constraint?
                                                   TODO Can we set this to 'last value in list'? -->
               <index enabled="false"/>
               <constraints>
                  <constraint ref="clf:classificationLevelRestriction"/>
               </constraints>
            </property>
         </properties>
      </aspect>
   </aspects>
</model>