<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>

   <!-- Bootstrap Records Management Models -->
   <bean id="org_alfresco_module_rm_dictionaryBootstrap" parent="dictionaryModelBootstrap" depends-on="siteService_dictionaryBootstrap">
      <property name="models">
         <list>
            <value>alfresco/module/org_alfresco_module_rm/model/recordsModel.xml</value>
         </list>
      </property>
      <property name="labels">
         <list>
            <value>alfresco/module/org_alfresco_module_rm/messages/records-model</value>
         </list>
      </property>
   </bean>
   <bean id="org_alfresco_module_rm_customModelsRepositoryLocation" class="org.alfresco.repo.dictionary.RepositoryLocation">
      <property name="path">
         <value>/app:company_home/app:dictionary/cm:records_management</value>
      </property>
      <property name="queryLanguage">
         <value>path</value>
      </property>
   </bean>
   <bean id="org_alfresco_module_rm_dictionaryRepositoryBootstrap" parent="dictionaryRepositoryBootstrap">
      <property name="repositoryModelsLocations">
         <list>
            <ref bean="org_alfresco_module_rm_customModelsRepositoryLocation" />
         </list>
      </property>
   </bean>

   <bean id="org_alfresco_module_rm_BaseBehaviour" abstract="true" init-method="init">
      <property name="nodeService" ref="NodeService"/>
      <property name="policyComponent" ref="policyComponent"/>
   </bean>

   <!--  File plan component aspect behaviour bean -->
   <bean id="org_alfresco_module_rm_FilePlanComponentAspect"
      class="org.alfresco.module.org_alfresco_module_rm.model.behaviour.FilePlanComponentAspect"
      parent="org_alfresco_module_rm_BaseBehaviour">
      <property name="filePlanService" ref="filePlanService"/>
   </bean>

   <bean id="org_alfresco_module_rm_ScheduledAspect"
      class="org.alfresco.module.org_alfresco_module_rm.model.behaviour.ScheduledAspect"
      parent="org_alfresco_module_rm_BaseBehaviour">
      <property name="dispositionService" ref="dispositionService"/>
   </bean>

   <bean id="org_alfresco_module_rm_RmSiteType"
      class="org.alfresco.module.org_alfresco_module_rm.model.behaviour.RmSiteType"
      parent="org_alfresco_module_rm_BaseBehaviour">
      <property name="siteService" ref="SiteService"/>
      <property name="recordsManagementSearchService" ref="RecordsManagementSearchService" />
      <property name="capabilityService" ref="CapabilityService" />
   </bean>

   <!--  Record Component Identifier aspect behaviour bean -->
   <bean id="recordComponentIdentifierAspect"
      class="org.alfresco.module.org_alfresco_module_rm.model.behaviour.RecordComponentIdentifierAspect"
      parent="org_alfresco_module_rm_BaseBehaviour">
      <property name="attributeService" ref="attributeService"/>
      <property name="filePlanService" ref="FilePlanService" />
   </bean>

   <!-- Copy policy management for records -->
   <bean id="recordCopyBehaviours"
      class="org.alfresco.module.org_alfresco_module_rm.model.behaviour.RecordCopyBehaviours"
      init-method="init">
      <property name="policyComponent" ref="policyComponent"/>
      <property name="behaviourFilter" ref="policyBehaviourFilter"/>
      <property name="recordsManagementServiceRegistry" ref="RecordsManagementServiceRegistry"/>
   </bean>

   <!-- Search Behaviour -->
   <bean id="recordsManagementSearchBehaviour"
      class="org.alfresco.module.org_alfresco_module_rm.model.behaviour.RecordsManagementSearchBehaviour"
      parent="org_alfresco_module_rm_BaseBehaviour">
      <property name="dispositionService" ref="dispositionService"/>
      <property name="recordsManagementServiceRegistry" ref="RecordsManagementServiceRegistry"/>
      <property name="vitalRecordService" ref="VitalRecordService"/>
      <property name="nodeService" ref="nodeService"/>
      <property name="recordService" ref="recordService"/>
      <property name="recordFolderService" ref="RecordFolderService"/>
   </bean>
   
   <!-- NEW BEHAVIOUR BEANS -->
   
   <bean id="rm.baseBehaviour" abstract="true">
   	  <property name="nodeService" ref="NodeService" />
      <property name="dictionaryService" ref="DictionaryService" />
      <property name="behaviourFilter" ref="policyBehaviourFilter" />
   </bean>
   
   <!--  rma model types -->
   
   <bean id="rma.recordsManagementContainer" class="org.alfresco.module.org_alfresco_module_rm.model.rma.type.RecordsManagementContainerType" parent="rm.baseBehaviour">
      <property name="identifierService" ref="recordsManagementIdentifierService"/>
   </bean>
   
   <bean id="rma.filePlan" class="org.alfresco.module.org_alfresco_module_rm.model.rma.type.FilePlanType" parent="rm.baseBehaviour">
      <property name="identifierService" ref="recordsManagementIdentifierService"/>
   	  <property name="filePlanService" ref="FilePlanService" />
   	  <property name="recordFolderService" ref="RecordFolderService" />
   	  <property name="filePlanRoleService" ref="FilePlanRoleService" />
   </bean>
   
   <bean id="rma.recordCategory" class="org.alfresco.module.org_alfresco_module_rm.model.rma.type.RecordCategoryType" parent="rm.baseBehaviour">
   	  <property name="vitalRecordService" ref="VitalRecordService" />
   	  <property name="filePlanPermissionService" ref="FilePlanPermissionService" />
   </bean>

   <bean id="rma.dispositionActionDefinition" class="org.alfresco.module.org_alfresco_module_rm.model.rma.type.DispositionActionDefinitionType" parent="rm.baseBehaviour">
   </bean>
   
   <!-- rma model aspects -->
   
   <bean id="rma.filePlanComponent" class="org.alfresco.module.org_alfresco_module_rm.model.rma.aspect.FilePlanComponentAspect" parent="rm.baseBehaviour">
   	  <property name="scriptService" ref="ScriptService" />
   	  <property name="namespaceService" ref="NamespaceService" />
   </bean>
   
   <bean id="rma.record" class="org.alfresco.module.org_alfresco_module_rm.model.rma.aspect.RecordAspect" parent="rm.baseBehaviour">
   	  <property name="scriptService" ref="ScriptService" />
   	  <property name="extendedSecurityService" ref="ExtendedSecurityService" />
   </bean>
      
   <bean id="rma.recordComponentIdentifier" class="org.alfresco.module.org_alfresco_module_rm.model.rma.aspect.RecordComponentIdentifierAspect" parent="rm.baseBehaviour">
   </bean>
   
   <!-- END -->

   <!--  Base bean definition for customisable types bootstrap -->
   <bean id="customisableTypesBootstrap"
      abstract="true"
      class="org.alfresco.module.org_alfresco_module_rm.model.CustomisableTypesBootstrap"
      init-method="init">
      <property name="recordsManagementAdminService" ref="recordsManagementAdminService"/>
      <property name="namespaceService" ref="NamespaceService"/>
   </bean>

   <!--  Model Security Definitions -->
   <import resource="classpath:alfresco/module/org_alfresco_module_rm/model/rm-model-security-context.xml"/>

   <!-- Base bean definition for customisable email mapping keys bootstrap -->
   <bean id="customisableEmailMappingKeyBootstrap"
      abstract="true"
      class="org.alfresco.module.org_alfresco_module_rm.email.CustomisableEmailMappingKeyBootstrap"
      init-method="init">
      <property name="customEmailMappingService" ref="customEmailMappingService"/>
   </bean>

   <bean id="customEmailMappingKey"
      parent="customisableEmailMappingKeyBootstrap">
      <property name="customisable">
         <list>
            <!-- Add here new email mapping keys -->
         </list>
      </property>
   </bean>
</beans>